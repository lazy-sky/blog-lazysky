---
title: 'Pick Color - 다른 색깔 찾기 게임'
digest: '난이도가 점진적으로 증가하는 다른 색깔 고르기 웹 게임'
---

## Features

- 여러 칸의 사각형으로 이루어진 게임판이 표시되며, 그 중 하나만 색깔이 다릅니다.
- 각 단계는 제한시간이 있고, 정답을 고르면 다음 단계로 넘어가며 점수가 올라갑니다.
- 단계가 올라갈수록 정답과 오답의 색상 차이가 줄어듭니다.
- 게임이 종료되면 랭킹에 자신의 점수를 기록할 수 있고 다른 사용자들의 점수를 확인할 수 있습니다.

## Learnings & Retrospect

- 처음으로 타입스크립트와 파이어베이스를 학습하여 프로젝트에 적용
- 의도와 다른 상태 변경 로직
    - `setState`가 비동기로 동작하기 때문에 어떤 식으로 상태를 관리해야 의도대로 동작하는지 감이 생긴 것이 다행이었다. (e.g., 함수형 `setState`) 남은 시간을 필두로 단계, 점수 등 알맞은 절차로 변경되어야 하는 상태 값들이 있는데 커스텀 훅, `useEffect`, `useState`의 적절한 사용으로 해결할 수 있었다.
- 타이머 구현
    - 커스텀 훅 `useInterval`을 이용하여 설정된 인터벌마다 남은 시간이 갱신된다. 이는 `setInterval`을 직접적으로 이용하는 것보다 여러 면에서 낫다.
        - 만약 `useEffect`와 `setInterval` 만을 이용하여 타이머를 구현하면 빈 의존 배열에 따라 첫 mount 시점에만 타이머 실행된다. 그리고 그 이후로는 내부 코드가 실행되지 않기 때문에 `setInterval`의 클로저는 첫 콜백을 계속해서 유지한다.  이는 `setInterval`과 리액트 동작 방식에서 기인하는 문제다. 리액트의 컴포넌트가 `props`나 `state` 따위에 의존하여 새롭게 렌더링하는 것에 비해 `setInterval`은 한 번 설정이 되면 `clearInterval`을 제외하면 어떠한 변경이 불가능하다. `state`가 바뀌지 않는 문제는 함수형 `setState` 만으로도 해결할 수 있다. `props`의 경우 `useRef`를 이용하는 것으로 해결할 수 있다. `savedCallback`(`useRef`를 통해 생성)의 `current` 프로퍼티에 `setInterval`의 콜백을 저장하고 계속해서 이 콜백을 갱신해주는 식이다.
        - 한편 이를 커스텀 훅으로 분리하는 것으로 보다 명령적으로 코드를 작성할 수 있을 뿐 아니라 컴포넌트 내부에선 타이머가 돌아가는 로직에 대해 관심갖지 않도록 할 수 있다.
- ColorBoard 구현
    - 구현 사항 중 가장 핵심이라 할 수 있는 색깔판은 겉으로 보기엔 행과 열을 가진 하나의 표 형태로 보인다. 그래서 처음엔 이차원 배열의 느낌으로 접근했었다. 그러다보니 매 단계마다 변하는 배열의 크기가 부담스럽게 느껴졌다. 이차원 배열로 구현하게 되면 어쩔 수 없이 일차원 배열에 비해 반복문에 뎁스가 하나 늘어날 수 밖에 없는데, 그것이 썩 마음에 들지 않았다. 그러다 문득 깨달은 것이 색깔판이 표처럼 보이는 건 말그대로 그렇게 보일 뿐인 거라는 것이다. 배열이 flat하더라도 사용자가 보기에 행과 열이 존재한다면 문제되지 않는다. 그리고 그런 건 css의 역할이다.
    - 이런 결론을 내리게 되어 색깔판의 state는 일차원 배열로 두고, css grid를 이용하여 이차원으로 보이도록 했다.